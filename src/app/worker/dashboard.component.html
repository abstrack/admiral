<h1>Dashboard</h1>
<button (click)="moveWeekBack()">Previous week</button>
<button (click)="moveWeekForward()">Next week</button>
<div style="margin: 10px">
  <input type="text" class="form-control" #searchBox placeholder="Project"
         (keyup)="search(searchBox.value)" [ngStyle]="{'width': '100px'}">
  <table style="width:100%; font-size: small">
    <thead>
    <tr>
      <th>סה"כ</th>
      <th>{{currentSunday.toDateString()}}</th>
      <th>{{getDayByWeek(currentSunday, 1).toDateString()}}</th>
      <th>{{getDayByWeek(currentSunday, 2).toDateString()}}</th>
      <th>{{getDayByWeek(currentSunday, 3).toDateString()}}</th>
      <th>{{getDayByWeek(currentSunday, 4).toDateString()}}</th>
      <th>{{getDayByWeek(currentSunday, 5).toDateString()}}</th>
      <th>{{getDayByWeek(currentSunday, 6).toDateString()}}</th>
      <th>פרויקט</th>
      <th>לקןח</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let item of uiAgreements">
      <td>
        {{sum(item.workInfos)}}
      </td>
      <td *ngFor="let work of item.workInfos">
        <span (click)="showDialog(work, item.clientName)">
        <input [ngStyle]="{'width': '100px'}"
               [ngModel]="(work.absenceType==''||work.absenceType==null)? work.duration: work.absenceType"
               style="width: inherit; text-align: center" disabled>
        </span>
      </td>
      <td>
        {{item.projectName}}
      </td>
      <td>
        {{item.clientName}}
      </td>
    </tr>
    </tbody>
  </table>
  <p-dialog title="{{dayForCreatingWorkInfos}}" modal="modal" [(visible)]="display" width="500"
            position="center center">
    <p-header>
      {{dayForCreatingWorkInfos}}
    </p-header>
    <div style="min-height: 350px ;max-height: 550px">
      <div style="text-align: center">
        <h3>
          {{clientForCreatingWorkInfos}}-עבודה יומי ב
        </h3>
      </div>
      <button type="button" class="btn btn-xs btn-info" (click)="create()">הוסיף</button>
      <div class="row">
        <table class="table table-hover">
          <thead>
          <tr>
            <th style="width: 10%"></th>
            <th style="width: 10%"></th>
            <th style="width: 16%">תאור</th>
            <th style="width: 16%">משך</th>
            <th style="width: 16%">חופשה</th>
            <th style="width: 16%">עד-</th>
            <th style="width: 16%">מ-</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let workInfo of dayWorkInfos">
            <td>
              <button type="button" class="btn btn-xs btn-danger" (click)="remove(workInfo)">מחק</button>
            </td>
            <td>
              <button type="button" class="btn btn-xs btn-warning" (click)="edit(workInfo)">ערוך</button>
            </td>
            <td>{{workInfo.comment}}</td>
            <td>{{workInfo.duration}}</td>
            <td>{{workInfo.absenceType}}</td>
            <td>{{workInfo.to}}</td>
            <td>{{workInfo.from}}</td>
          </tr>
          </tbody>
        </table>
      </div>
      <div *ngIf="createDialog">
        <div>
          <p-inputMask [(ngModel)]="workInfoItem.from" mask="99:99" [maxlength]="5"></p-inputMask>
          <p-inputMask [(ngModel)]="workInfoItem.to" mask="99:99" [maxlength]="5"></p-inputMask>
        </div>
        <div>
          <p-dropdown [options]="absenceTypes" [style]="{'width':'150px'}" placeholder="בחר את סוג"
                      [(ngModel)]="workInfoItem.absenceType"></p-dropdown>
        </div>
        <div>
          <textarea pInputTextarea [(ngModel)]="workInfoItem.comment" [maxlength]="50"></textarea>
        </div>
        <button type="button" pButton icon="fa-check" (click)="save(workInfoItem)" label="Save"></button>
        <!--<button class="ui-g-12 ui-md-2" (click)="save(workInfo)">Save</button>-->
      </div>

    </div>
    <p-footer>
      <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
        <button type="button" pButton icon="fa-check" (click)="closeDialog()" label="Ok"></button>
      </div>
    </p-footer>
  </p-dialog>

</div>
